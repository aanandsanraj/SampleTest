ClearCollect(
    FilteredFolders,
    Filter(
        FilterStepFolders,
        temp = true
    )
);
Set(
    FolderNamesToCreate,
    Concat(
        FilteredFolders,
        dwf_stepsfoldername & ","
    )
);
Set(
    FolderNamesToCreate,
    Left(
        FolderNamesToCreate,
        Len(FolderNamesToCreate) - 1
    )
);
Set(
    CreatedFolderFlow,
    CreateStepFolder.Run(
        SPSubSiteURL,
        "Documents",
        FolderNamesToCreate
    )
);
If(
    CreatedFolderFlow.issuccess = "True",
    Set(
        SuccessfulCreatedFolderArray,
        Split(
            CreatedFolderFlow.createdfolder,
            ","
        )
    );
    ForAll(
        SuccessfulCreatedFolderArray,
        Patch(
            StepsFolders,
            Defaults(StepsFolders),
            {
                'Project Transaction Name': LookUp(
                    ProjectTransactions,
                    ID = First(ProjectTransactionData).ID
                ),
                'Steps Folder Name': Value,
                'Submitted By': LookUp(
                    Users,
                    'Primary Email' = User().Email
                )
            }
        )
    );
    Refresh(StepsFolders);
    ClearCollect(
        FilterStepFolders,
        ShowColumns(
            Filter(
                StepsFolders,
                'Project Transaction Name'.'Project Transaction' = First(ProjectTransactionData).'Project Transaction'
            ),
            'Steps Folder',
            'Steps Folder Name'
        )
    );
    Set(
        IsAddFolder,
        false
    );
    Set(
        IsEditStepFolder,
        true
    );
    Notify(
        Concatenate(
            CreatedFolderFlow.createdfolder,
            " folder created successfully"
        )
    );
    ,
    Notify(
        Concatenate(
            "Unable to create the folder ",
            CreatedFolderFlow.createdfolder
        ),
        NotificationType.Error,
        5000
    )
);

/Forms Library US/Execution Documents/C-13 Contribution Commitment Funds Request.docx
/Forms Library US/Debt Documents/L-13 Loan Reconciliation for Note XX-R-XX to Note XX-R-XX.docx

/Forms Library US/Execution Documents/C-05 Consent in Writing.doc
/Forms Library US/Execution Documents/C-06 Contribution Agreement.doc

Forms Library US/Execution Documents/C-24 Consent to Annual Transfers.docForms Library US/Execution Documents/C-24 Consent to Annual Transfers.docForms Library US/Execution Documents/C-24 Consent to Annual Transfers.doc

'Tax_TD Transaction Project'

If(
    AddUpdateButtonName = "Update",
    true,
    false
)


If(IsBlank(ProjectNumber), Parent.Default, ProjectNumber)
